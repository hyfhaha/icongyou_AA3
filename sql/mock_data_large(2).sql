-- =========================================
-- 庞大的测试数据：主角学生 + 多门课程 + 大量任务
-- 主角学生：id=201，选4门课程（不同学期、不同类别）
-- 其他学生：202-215（14个学生）
-- 每门课程：>10个任务，多个epic和阶段
-- =========================================

SET FOREIGN_KEY_CHECKS = 0;

--
-- 清理之前由本脚本生成的测试数据（按课程 / 用户范围）
-- 仅影响课程ID 1001-1005、用户ID 100-220 相关的数据
--
DELETE FROM task_views WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_student_work_favorite WHERE story_id BETWEEN 10001 AND 40013;
DELETE FROM course_student_work_like    WHERE story_id BETWEEN 10001 AND 40013;
DELETE FROM course_student_work         WHERE course_id BETWEEN 1001 AND 1005;

DELETE FROM discussions WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM messages
  WHERE sender_id  BETWEEN 100 AND 220
     OR receiver_id BETWEEN 100 AND 220;

DELETE FROM course_student WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_group   WHERE course_id BETWEEN 1001 AND 1005;

DELETE FROM course_map_story_material WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_map_story          WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_map_release        WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_map_epic           WHERE course_id BETWEEN 1001 AND 1005;
DELETE FROM course_map_goal           WHERE course_id BETWEEN 1001 AND 1005;

DELETE FROM course WHERE course_id BETWEEN 1001 AND 1005;

DELETE FROM `user` WHERE id BETWEEN 100 AND 220;

-- 1. 用户：老师 + 15个学生（主角201 + 其他202-215），补全学号/手机号/邮箱等字段
INSERT INTO `user` (
  id, username, password_hash, nickname,
  dept_id, email, phone_number, job_number,
  user_role, status, deleted, tenant_id
) VALUES
  -- 老师（dept_id 设为 10，工号 T100+）
  (100, 'teacher_zhang', '123456', '张老师', 10, 'teacher_zhang@example.com', '13800001000', 'T100', 1, 1, 0, 0),
  (101, 'teacher_wang',  '123456', '王老师', 10, 'teacher_wang@example.com',  '13800001001', 'T101', 1, 1, 0, 0),
  (102, 'teacher_li',    '123456', '李老师', 10, 'teacher_li@example.com',    '13800001002', 'T102', 1, 1, 0, 0),
  (103, 'teacher_zhao',  '123456', '赵老师', 10, 'teacher_zhao@example.com',  '13800001003', 'T103', 1, 1, 0, 0),
  (104, 'teacher_chen',  '123456', '陈老师', 10, 'teacher_chen@example.com',  '13800001004', 'T104', 1, 1, 0, 0),

  -- 主角学生 201（dept_id 设为 101，学号 S201）
  (201, 'hero_student', '123456', '主角学生', 101, '201001@example.com', '13900002001', 'S201', 0, 1, 0, 0),

  -- 其他学生 202-215
  (202, 'stu202', '123456', '学生202', 101, '202001@example.com', '13900002002', 'S202', 0, 1, 0, 0),
  (203, 'stu203', '123456', '学生203', 101, '203001@example.com', '13900002003', 'S203', 0, 1, 0, 0),
  (204, 'stu204', '123456', '学生204', 101, '204001@example.com', '13900002004', 'S204', 0, 1, 0, 0),
  (205, 'stu205', '123456', '学生205', 101, '205001@example.com', '13900002005', 'S205', 0, 1, 0, 0),
  (206, 'stu206', '123456', '学生206', 101, '206001@example.com', '13900002006', 'S206', 0, 1, 0, 0),
  (207, 'stu207', '123456', '学生207', 101, '207001@example.com', '13900002007', 'S207', 0, 1, 0, 0),
  (208, 'stu208', '123456', '学生208', 101, '208001@example.com', '13900002008', 'S208', 0, 1, 0, 0),
  (209, 'stu209', '123456', '学生209', 101, '209001@example.com', '13900002009', 'S209', 0, 1, 0, 0),
  (210, 'stu210', '123456', '学生210', 101, '210001@example.com', '13900002010', 'S210', 0, 1, 0, 0),
  (211, 'stu211', '123456', '学生211', 101, '211001@example.com', '13900002011', 'S211', 0, 1, 0, 0),
  (212, 'stu212', '123456', '学生212', 101, '212001@example.com', '13900002012', 'S212', 0, 1, 0, 0),
  (213, 'stu213', '123456', '学生213', 101, '213001@example.com', '13900002013', 'S213', 0, 1, 0, 0),
  (214, 'stu214', '123456', '学生214', 101, '214001@example.com', '13900002014', 'S214', 0, 1, 0, 0),
  (215, 'stu215', '123456', '学生215', 101, '215001@example.com', '13900002015', 'S215', 0, 1, 0, 0)
ON DUPLICATE KEY UPDATE
  username     = VALUES(username),
  nickname     = VALUES(nickname),
  user_role    = VALUES(user_role),
  email        = VALUES(email),
  phone_number = VALUES(phone_number),
  job_number   = VALUES(job_number);

--
-- 2. 课程：5门课程，不同学期、不同类别
--    主角学生201会选课程1001-1004（4门）
--
INSERT INTO course (
  course_id, course_name, course_desc, semester,
  start_time, end_time, lesson_status, show_score,
  course_type, course_hour, standard_team_num,
  teacher_ids, teacher_names,
  deleted, tenant_id
) VALUES
  -- 课程1001：2024春，必修课
  (1001, '软件工程实践', '系统学习软件工程全流程，包括需求分析、系统设计、编码实现、测试部署等环节。', '2024春',
   '2024-02-20 00:00:00', '2024-06-30 23:59:59',
   99, 1,
   3, 64, 5,
   '100', '张老师',
   b'0', 0),

  -- 课程1002：2024秋，实训课
  (1002, 'Web全栈开发实训', '从前端到后端的完整开发实践，包含React、Node.js、数据库设计等。', '2024秋',
   '2024-09-01 00:00:00', '2024-12-31 23:59:59',
   1, 1,
   1, 80, 6,
   '101', '王老师',
   b'0', 0),

  -- 课程1003：2024秋，选修课
  (1003, '人工智能基础', '介绍机器学习、深度学习基础理论，包含实践项目。', '2024秋',
   '2024-09-01 00:00:00', '2024-12-31 23:59:59',
   1, 1,
   4, 48, 4,
   '102', '李老师',
   b'0', 0),

  -- 课程1004：2025春，公共基础课
  (1004, '数据结构与算法', '系统学习常用数据结构和算法，提升编程能力。', '2025春',
   '2025-02-20 00:00:00', '2025-06-30 23:59:59',
   0, 1,
   5, 64, 5,
   '103', '赵老师',
   b'0', 0),

  -- 课程1005：2024秋，活动课（主角不选，其他学生选）
  (1005, '创新创业实践', '通过项目实践培养创新思维和创业能力。', '2024秋',
   '2024-09-01 00:00:00', '2024-12-31 23:59:59',
   1, 1,
   2, 32, 4,
   '104', '陈老师',
   b'0', 0)
ON DUPLICATE KEY UPDATE
  course_name = VALUES(course_name),
  course_desc = VALUES(course_desc),
  teacher_ids = VALUES(teacher_ids),
  teacher_names = VALUES(teacher_names);

--
-- 3. 课程目标（course_map_goal）
--    每门课程3-4个goal
--
INSERT IGNORE INTO course_map_goal (
  id, course_id, goal_name, goal_desc, goal_level, goal_reference,
  sort, deleted, tenant_id
) VALUES
  -- 课程1001：软件工程实践（4个goal）
  (1001, 1001, '需求分析与建模', '能够完成系统需求分析，建立需求模型。', 'H', 'SE1', 1, b'0', 0),
  (1002, 1001, '系统设计与架构', '能够设计系统架构，完成详细设计。', 'H', 'SE2', 2, b'0', 0),
  (1003, 1001, '团队协作能力', '在团队项目中有效协作与沟通。', 'M', 'SE3', 3, b'0', 0),
  (1004, 1001, '文档编写能力', '撰写规范的软件工程文档。', 'M', 'SE4', 4, b'0', 0),

  -- 课程1002：Web全栈开发（4个goal）
  (2001, 1002, '前端开发能力', '掌握现代前端框架，能够开发响应式界面。', 'H', 'WEB1', 1, b'0', 0),
  (2002, 1002, '后端开发能力', '能够设计和实现RESTful API。', 'H', 'WEB2', 2, b'0', 0),
  (2003, 1002, '数据库设计能力', '能够设计合理的数据库结构。', 'M', 'WEB3', 3, b'0', 0),
  (2004, 1002, '部署与运维能力', '能够将应用部署到生产环境。', 'L', 'WEB4', 4, b'0', 0),

  -- 课程1003：人工智能基础（3个goal）
  (3001, 1003, '机器学习理论', '理解机器学习基本理论和算法。', 'H', 'AI1', 1, b'0', 0),
  (3002, 1003, '深度学习实践', '能够使用深度学习框架完成项目。', 'H', 'AI2', 2, b'0', 0),
  (3003, 1003, 'AI应用开发', '能够开发AI应用系统。', 'M', 'AI3', 3, b'0', 0),

  -- 课程1004：数据结构与算法（4个goal）
  (4001, 1004, '线性结构掌握', '熟练掌握数组、链表、栈、队列等线性结构。', 'H', 'DS1', 1, b'0', 0),
  (4002, 1004, '树与图算法', '掌握树和图的基本算法。', 'H', 'DS2', 2, b'0', 0),
  (4003, 1004, '排序与查找', '理解各种排序和查找算法。', 'M', 'DS3', 3, b'0', 0),
  (4004, 1004, '算法设计能力', '能够针对问题设计合适的算法。', 'H', 'DS4', 4, b'0', 0),

  -- 课程1005：创新创业实践（3个goal）
  (5001, 1005, '创新思维培养', '培养创新思维和问题解决能力。', 'M', 'INN1', 1, b'0', 0),
  (5002, 1005, '商业模式设计', '能够设计可行的商业模式。', 'M', 'INN2', 2, b'0', 0),
  (5003, 1005, '项目路演能力', '能够进行项目展示和路演。', 'L', 'INN3', 3, b'0', 0);

--
-- 4. 史诗（course_map_epic）- 用于X轴坐标
--    每个goal对应1-2个epic，按sort排序确定position_x
--
INSERT IGNORE INTO course_map_epic (
  id, course_id, goal_id, epic_name, sort,
  deleted, tenant_id
) VALUES
  -- 课程1001：软件工程实践
  -- Goal 1001 -> Epic 1,2 (x=1,2)
  -- Goal 1002 -> Epic 3,4 (x=3,4)
  -- Goal 1003 -> Epic 5 (x=5)
  -- Goal 1004 -> Epic 6 (x=6)
  (1001, 1001, 1001, '需求调研与分析', 1, b'0', 0),
  (1002, 1001, 1001, '需求建模', 2, b'0', 0),
  (1003, 1001, 1002, '系统架构设计', 3, b'0', 0),
  (1004, 1001, 1002, '详细设计', 4, b'0', 0),
  (1005, 1001, 1003, '团队协作实践', 5, b'0', 0),
  (1006, 1001, 1004, '文档编写', 6, b'0', 0),

  -- 课程1002：Web全栈开发
  -- Goal 2001 -> Epic 1,2 (x=1,2)
  -- Goal 2002 -> Epic 3 (x=3)
  -- Goal 2003 -> Epic 4 (x=4)
  -- Goal 2004 -> Epic 5 (x=5)
  (2001, 1002, 2001, '前端基础', 1, b'0', 0),
  (2002, 1002, 2001, '前端框架', 2, b'0', 0),
  (2003, 1002, 2002, '后端API开发', 3, b'0', 0),
  (2004, 1002, 2003, '数据库设计', 4, b'0', 0),
  (2005, 1002, 2004, '部署实践', 5, b'0', 0),

  -- 课程1003：人工智能基础
  -- Goal 3001 -> Epic 1,2 (x=1,2)
  -- Goal 3002 -> Epic 3 (x=3)
  -- Goal 3003 -> Epic 4 (x=4)
  (3001, 1003, 3001, '机器学习基础', 1, b'0', 0),
  (3002, 1003, 3001, '监督学习', 2, b'0', 0),
  (3003, 1003, 3002, '深度学习框架', 3, b'0', 0),
  (3004, 1003, 3003, 'AI项目开发', 4, b'0', 0),

  -- 课程1004：数据结构与算法
  -- Goal 4001 -> Epic 1,2 (x=1,2)
  -- Goal 4002 -> Epic 3 (x=3)
  -- Goal 4003 -> Epic 4 (x=4)
  -- Goal 4004 -> Epic 5 (x=5)
  (4001, 1004, 4001, '线性表', 1, b'0', 0),
  (4002, 1004, 4001, '栈与队列', 2, b'0', 0),
  (4003, 1004, 4002, '树与图', 3, b'0', 0),
  (4004, 1004, 4003, '排序查找', 4, b'0', 0),
  (4005, 1004, 4004, '算法设计', 5, b'0', 0),

  -- 课程1005：创新创业实践
  (5001, 1005, 5001, '创新思维训练', 1, b'0', 0),
  (5002, 1005, 5002, '商业模式', 2, b'0', 0),
  (5003, 1005, 5003, '项目路演', 3, b'0', 0);

--
-- 5. 阶段（course_map_release）- 用于Y轴坐标
--    每门课程2-3个阶段
--
INSERT IGNORE INTO course_map_release (
  id, course_id, release_name, release_desc,
  deleted, tenant_id
) VALUES
  -- 课程1001：3个阶段
  (1001, 1001, '阶段1：需求与设计', '完成需求分析和系统设计。', b'0', 0),
  (1002, 1001, '阶段2：开发实现', '完成系统编码和单元测试。', b'0', 0),
  (1003, 1001, '阶段3：测试与部署', '完成系统测试和部署上线。', b'0', 0),

  -- 课程1002：3个阶段
  (2001, 1002, '阶段1：前端开发', '完成前端界面和交互开发。', b'0', 0),
  (2002, 1002, '阶段2：后端开发', '完成后端API和数据库开发。', b'0', 0),
  (2003, 1002, '阶段3：集成与部署', '完成前后端集成和项目部署。', b'0', 0),

  -- 课程1003：2个阶段
  (3001, 1003, '阶段1：理论学习', '学习机器学习和深度学习理论。', b'0', 0),
  (3002, 1003, '阶段2：项目实践', '完成AI项目开发实践。', b'0', 0),

  -- 课程1004：3个阶段
  (4001, 1004, '阶段1：线性结构', '学习数组、链表、栈、队列。', b'0', 0),
  (4002, 1004, '阶段2：树与图', '学习树和图的基本算法。', b'0', 0),
  (4003, 1004, '阶段3：综合应用', '完成综合算法设计项目。', b'0', 0),

  -- 课程1005：2个阶段
  (5001, 1005, '阶段1：创新训练', '完成创新思维训练项目。', b'0', 0),
  (5002, 1005, '阶段2：创业实践', '完成商业模式设计和路演。', b'0', 0);

--
-- 6. 任务（course_map_story）
--    每门课程 >10个任务，严格遵守坐标规则
--    position_x = epic的sort序号
--    position_y = release的阶段序号（1,2,3...）
--
INSERT IGNORE INTO course_map_story (
  id, course_id, goal_id, epic_id, release_id,
  story_name, story_desc,
  story_type, submit_type, total_score,
  max_contribute, min_contribute,
  start_time, end_time,
  examine_type, position_x, position_y,
  deleted, tenant_id
) VALUES
  -- ========== 课程1001：软件工程实践（15个任务）==========
  -- Epic 1 (x=1), Release 1 (y=1)
  (10001, 1001, 1001, 1001, 1001, '项目选题报告（个人）', '完成项目选题并提交简要说明。', 1, 2, 10, NULL, 0, '2024-02-25 00:00:00', '2024-03-05 23:59:59', 1, 1, 1, b'0', 0),
  (10002, 1001, 1001, 1001, 1001, '用户需求调研（团队-队长提交）', '小组完成用户需求调研并整理报告。', 2, 2, 20, 60, 10, '2024-03-01 00:00:00', '2024-03-15 23:59:59', 1, 1, 1, b'0', 0),
  
  -- Epic 2 (x=2), Release 1 (y=1)
  (10003, 1001, 1001, 1002, 1001, '用例图绘制（个人）', '根据需求绘制完整用例图。', 1, 2, 15, NULL, 0, '2024-03-05 00:00:00', '2024-03-15 23:59:59', 1, 2, 1, b'0', 0),
  (10004, 1001, 1001, 1002, 1001, 'ER图设计（个人）', '完成数据库ER图设计。', 1, 2, 15, NULL, 0, '2024-03-10 00:00:00', '2024-03-20 23:59:59', 1, 2, 1, b'0', 0),
  
  -- Epic 3 (x=3), Release 1 (y=1)
  (10005, 1001, 1002, 1003, 1001, '系统架构设计（团队-队长提交）', '完成系统整体架构设计文档。', 2, 2, 30, 70, 10, '2024-03-15 00:00:00', '2024-03-30 23:59:59', 1, 3, 1, b'0', 0),
  
  -- Epic 4 (x=4), Release 1 (y=1)
  (10006, 1001, 1002, 1004, 1001, '详细设计文档（团队-队长提交）', '完成模块详细设计文档。', 2, 2, 25, 65, 10, '2024-03-20 00:00:00', '2024-04-05 23:59:59', 1, 4, 1, b'0', 0),
  
  -- Epic 3 (x=3), Release 2 (y=2)
  (10007, 1001, 1002, 1003, 1002, '核心模块开发（团队-全员提交）', '每位成员完成负责模块的开发。', 3, 2, 40, 80, 5, '2024-04-10 00:00:00', '2024-05-10 23:59:59', 1, 3, 2, b'0', 0),
  (10008, 1001, 1002, 1003, 1002, '单元测试报告（个人）', '完成所负责模块的单元测试。', 1, 2, 15, NULL, 0, '2024-05-05 00:00:00', '2024-05-15 23:59:59', 1, 3, 2, b'0', 0),
  
  -- Epic 4 (x=4), Release 2 (y=2)
  (10009, 1001, 1002, 1004, 1002, '接口联调测试（团队-队长提交）', '完成前后端接口联调。', 2, 2, 20, 60, 10, '2024-05-10 00:00:00', '2024-05-25 23:59:59', 1, 4, 2, b'0', 0),
  
  -- Epic 5 (x=5), Release 2 (y=2)
  (10010, 1001, 1003, 1005, 1002, '团队协作总结（团队-队长提交）', '总结团队协作经验与问题。', 2, 2, 15, 50, 10, '2024-05-15 00:00:00', '2024-05-30 23:59:59', 1, 5, 2, b'0', 0),
  
  -- Epic 6 (x=6), Release 1 (y=1)
  (10011, 1001, 1004, 1006, 1001, '需求规格说明书（团队-队长提交）', '完成SRS文档编写。', 2, 2, 30, 70, 10, '2024-03-10 00:00:00', '2024-03-25 23:59:59', 1, 6, 1, b'0', 0),
  
  -- Epic 6 (x=6), Release 2 (y=2)
  (10012, 1001, 1004, 1006, 1002, '开发文档编写（团队-全员提交）', '每位成员编写负责模块的开发文档。', 3, 2, 20, 75, 5, '2024-05-01 00:00:00', '2024-05-20 23:59:59', 1, 6, 2, b'0', 0),
  
  -- Epic 3 (x=3), Release 3 (y=3)
  (10013, 1001, 1002, 1003, 1003, '系统集成测试（团队-队长提交）', '完成系统整体集成测试。', 2, 2, 25, 65, 10, '2024-05-25 00:00:00', '2024-06-10 23:59:59', 1, 3, 3, b'0', 0),
  (10014, 1001, 1002, 1003, 1003, '性能测试报告（个人）', '完成系统性能测试分析。', 1, 2, 15, NULL, 0, '2024-06-01 00:00:00', '2024-06-15 23:59:59', 1, 3, 3, b'0', 0),
  
  -- Epic 4 (x=4), Release 3 (y=3)
  (10015, 1001, 1002, 1004, 1003, '项目部署上线（团队-队长提交）', '完成项目部署到生产环境。', 2, 2, 30, 70, 10, '2024-06-10 00:00:00', '2024-06-25 23:59:59', 1, 4, 3, b'0', 0),

  -- ========== 课程1002：Web全栈开发（12个任务）==========
  -- Epic 1 (x=1), Release 1 (y=1)
  (20001, 1002, 2001, 2001, 2001, 'HTML/CSS基础练习（个人）', '完成静态页面开发练习。', 1, 2, 10, NULL, 0, '2024-09-05 00:00:00', '2024-09-15 23:59:59', 1, 1, 1, b'0', 0),
  (20002, 1002, 2001, 2001, 2001, 'JavaScript基础（个人）', '完成JavaScript基础语法练习。', 1, 2, 15, NULL, 0, '2024-09-10 00:00:00', '2024-09-20 23:59:59', 1, 1, 1, b'0', 0),
  
  -- Epic 2 (x=2), Release 1 (y=1)
  (20003, 1002, 2001, 2002, 2001, 'React组件开发（团队-全员提交）', '每位成员开发一个React组件。', 3, 2, 25, 80, 5, '2024-09-15 00:00:00', '2024-10-05 23:59:59', 1, 2, 1, b'0', 0),
  (20004, 1002, 2001, 2002, 2001, '前端路由设计（个人）', '完成前端路由配置。', 1, 2, 15, NULL, 0, '2024-09-20 00:00:00', '2024-10-01 23:59:59', 1, 2, 1, b'0', 0),
  
  -- Epic 3 (x=3), Release 2 (y=2)
  (20005, 1002, 2002, 2003, 2002, 'RESTful API设计（团队-队长提交）', '设计并实现RESTful API接口。', 2, 2, 30, 70, 10, '2024-10-05 00:00:00', '2024-10-25 23:59:59', 1, 3, 2, b'0', 0),
  (20006, 1002, 2002, 2003, 2002, 'API接口测试（个人）', '完成API接口的单元测试。', 1, 2, 15, NULL, 0, '2024-10-15 00:00:00', '2024-10-30 23:59:59', 1, 3, 2, b'0', 0),
  
  -- Epic 4 (x=4), Release 2 (y=2)
  (20007, 1002, 2003, 2004, 2002, '数据库设计（团队-队长提交）', '完成数据库ER图和表结构设计。', 2, 2, 25, 65, 10, '2024-10-10 00:00:00', '2024-10-25 23:59:59', 1, 4, 2, b'0', 0),
  (20008, 1002, 2003, 2004, 2002, '数据库实现（个人）', '完成数据库表创建和初始化。', 1, 2, 15, NULL, 0, '2024-10-20 00:00:00', '2024-11-05 23:59:59', 1, 4, 2, b'0', 0),
  
  -- Epic 5 (x=5), Release 3 (y=3)
  (20009, 1002, 2004, 2005, 2003, '前后端联调（团队-队长提交）', '完成前后端接口联调测试。', 2, 2, 25, 65, 10, '2024-11-05 00:00:00', '2024-11-20 23:59:59', 1, 5, 3, b'0', 0),
  (20010, 1002, 2004, 2005, 2003, '项目部署（团队-队长提交）', '完成项目部署到服务器。', 2, 2, 30, 70, 10, '2024-11-15 00:00:00', '2024-12-05 23:59:59', 1, 5, 3, b'0', 0),
  (20011, 1002, 2004, 2005, 2003, '部署文档编写（个人）', '编写项目部署文档。', 1, 2, 10, NULL, 0, '2024-11-25 00:00:00', '2024-12-10 23:59:59', 1, 5, 3, b'0', 0),
  (20012, 1002, 2001, 2002, 2003, '项目总结报告（团队-队长提交）', '完成项目总结报告。', 2, 2, 20, 60, 10, '2024-12-01 00:00:00', '2024-12-20 23:59:59', 1, 2, 3, b'0', 0),

  -- ========== 课程1003：人工智能基础（11个任务）==========
  -- Epic 1 (x=1), Release 1 (y=1)
  (30001, 1003, 3001, 3001, 3001, '机器学习基础理论（个人）', '学习并总结机器学习基础理论。', 1, 2, 15, NULL, 0, '2024-09-05 00:00:00', '2024-09-20 23:59:59', 1, 1, 1, b'0', 0),
  (30002, 1003, 3001, 3001, 3001, '线性回归实践（个人）', '完成线性回归算法实现。', 1, 2, 20, NULL, 0, '2024-09-15 00:00:00', '2024-09-30 23:59:59', 1, 1, 1, b'0', 0),
  
  -- Epic 2 (x=2), Release 1 (y=1)
  (30003, 1003, 3001, 3002, 3001, '分类算法实践（团队-全员提交）', '每位成员实现一种分类算法。', 3, 2, 30, 75, 5, '2024-09-20 00:00:00', '2024-10-10 23:59:59', 1, 2, 1, b'0', 0),
  (30004, 1003, 3001, 3002, 3001, '模型评估报告（个人）', '完成模型评估指标分析。', 1, 2, 15, NULL, 0, '2024-10-05 00:00:00', '2024-10-15 23:59:59', 1, 2, 1, b'0', 0),
  
  -- Epic 3 (x=3), Release 2 (y=2)
  (30005, 1003, 3002, 3003, 3002, '深度学习框架学习（个人）', '学习TensorFlow或PyTorch框架。', 1, 2, 20, NULL, 0, '2024-10-10 00:00:00', '2024-10-25 23:59:59', 1, 3, 2, b'0', 0),
  (30006, 1003, 3002, 3003, 3002, '神经网络实现（团队-队长提交）', '实现一个简单的神经网络。', 2, 2, 35, 70, 10, '2024-10-15 00:00:00', '2024-11-05 23:59:59', 1, 3, 2, b'0', 0),
  (30007, 1003, 3002, 3003, 3002, 'CNN实践（个人）', '完成卷积神经网络实践。', 1, 2, 25, NULL, 0, '2024-10-25 00:00:00', '2024-11-10 23:59:59', 1, 3, 2, b'0', 0),
  
  -- Epic 4 (x=4), Release 2 (y=2)
  (30008, 1003, 3003, 3004, 3002, 'AI项目选题（团队-队长提交）', '确定AI项目方向。', 2, 2, 15, 50, 10, '2024-11-01 00:00:00', '2024-11-10 23:59:59', 1, 4, 2, b'0', 0),
  (30009, 1003, 3003, 3004, 3002, '数据预处理（团队-全员提交）', '完成项目数据预处理。', 3, 2, 20, 75, 5, '2024-11-10 00:00:00', '2024-11-25 23:59:59', 1, 4, 2, b'0', 0),
  (30010, 1003, 3003, 3004, 3002, '模型训练与优化（团队-队长提交）', '完成模型训练和参数优化。', 2, 2, 40, 75, 10, '2024-11-20 00:00:00', '2024-12-10 23:59:59', 1, 4, 2, b'0', 0),
  (30011, 1003, 3003, 3004, 3002, '项目总结报告（团队-队长提交）', '完成AI项目总结报告。', 2, 2, 25, 65, 10, '2024-12-05 00:00:00', '2024-12-20 23:59:59', 1, 4, 2, b'0', 0),

  -- ========== 课程1004：数据结构与算法（13个任务）==========
  -- Epic 1 (x=1), Release 1 (y=1)
  (40001, 1004, 4001, 4001, 4001, '顺序表实现（个人）', '实现顺序表的基本操作。', 1, 2, 15, NULL, 0, '2025-02-25 00:00:00', '2025-03-10 23:59:59', 1, 1, 1, b'0', 0),
  (40002, 1004, 4001, 4001, 4001, '链表实现（个人）', '实现单向和双向链表。', 1, 2, 20, NULL, 0, '2025-03-01 00:00:00', '2025-03-15 23:59:59', 1, 1, 1, b'0', 0),
  
  -- Epic 2 (x=2), Release 1 (y=1)
  (40003, 1004, 4001, 4002, 4001, '栈的实现与应用（个人）', '实现栈并完成应用案例。', 1, 2, 18, NULL, 0, '2025-03-05 00:00:00', '2025-03-20 23:59:59', 1, 2, 1, b'0', 0),
  (40004, 1004, 4001, 4002, 4001, '队列实现（个人）', '实现队列的基本操作。', 1, 2, 15, NULL, 0, '2025-03-10 00:00:00', '2025-03-25 23:59:59', 1, 2, 1, b'0', 0),
  
  -- Epic 3 (x=3), Release 2 (y=2)
  (40005, 1004, 4002, 4003, 4002, '二叉树遍历（团队-全员提交）', '每位成员实现一种遍历方式。', 3, 2, 25, 75, 5, '2025-03-20 00:00:00', '2025-04-10 23:59:59', 1, 3, 2, b'0', 0),
  (40006, 1004, 4002, 4003, 4002, '平衡二叉树（个人）', '实现AVL树或红黑树。', 1, 2, 30, NULL, 0, '2025-04-01 00:00:00', '2025-04-20 23:59:59', 1, 3, 2, b'0', 0),
  (40007, 1004, 4002, 4003, 4002, '图的基本操作（团队-队长提交）', '实现图的存储和基本操作。', 2, 2, 30, 70, 10, '2025-04-10 00:00:00', '2025-04-30 23:59:59', 1, 3, 2, b'0', 0),
  (40008, 1004, 4002, 4003, 4002, '最短路径算法（团队-队长提交）', '实现Dijkstra或Floyd算法。', 2, 2, 35, 75, 10, '2025-04-15 00:00:00', '2025-05-10 23:59:59', 1, 3, 2, b'0', 0),
  
  -- Epic 4 (x=4), Release 2 (y=2)
  (40009, 1004, 4003, 4004, 4002, '排序算法对比（团队-全员提交）', '对比多种排序算法性能。', 3, 2, 25, 80, 5, '2025-04-20 00:00:00', '2025-05-15 23:59:59', 1, 4, 2, b'0', 0),
  (40010, 1004, 4003, 4004, 4002, '查找算法实现（个人）', '实现二分查找和哈希查找。', 1, 2, 20, NULL, 0, '2025-05-01 00:00:00', '2025-05-20 23:59:59', 1, 4, 2, b'0', 0),
  
  -- Epic 5 (x=5), Release 3 (y=3)
  (40011, 1004, 4004, 4005, 4003, '算法设计题1（个人）', '完成动态规划算法题。', 1, 2, 25, NULL, 0, '2025-05-10 00:00:00', '2025-05-25 23:59:59', 1, 5, 3, b'0', 0),
  (40012, 1004, 4004, 4005, 4003, '算法设计题2（个人）', '完成贪心算法题。', 1, 2, 25, NULL, 0, '2025-05-15 00:00:00', '2025-05-30 23:59:59', 1, 5, 3, b'0', 0),
  (40013, 1004, 4004, 4005, 4003, '综合算法项目（团队-队长提交）', '完成综合算法设计项目。', 2, 2, 40, 75, 10, '2025-05-20 00:00:00', '2025-06-15 23:59:59', 1, 5, 3, b'0', 0);

--
-- 7. 小组（course_group）
--    主角学生201在每门课程（1001-1004）都有一个小组，他是队长
--
INSERT IGNORE INTO course_group (
  id, course_id, group_name, max_size, current_size,
  group_code, deleted, tenant_id
) VALUES
  (1001, 1001, '软工-第1组', 5, 5, 'SE-G1', b'0', 0),
  (1002, 1002, '全栈-第1组', 6, 6, 'WEB-G1', b'0', 0),
  (1003, 1003, 'AI-第1组', 4, 4, 'AI-G1', b'0', 0),
  (1004, 1004, '算法-第1组', 5, 5, 'DS-G1', b'0', 0),
  (1005, 1005, '创新-第1组', 4, 4, 'INN-G1', b'0', 0);

--
-- 8. 选课学生（course_student）
--    主角201选课程1001-1004，每门课程都是队长
--    其他学生也分配到各课程
--
INSERT IGNORE INTO course_student (
  id, course_id, student_id, group_id, leader,
  deleted, tenant_id
) VALUES
  -- 课程1001：主角201是队长，其他4个学生
  (10001, 1001, 201, 1001, 1, b'0', 0),
  (10002, 1001, 202, 1001, 0, b'0', 0),
  (10003, 1001, 203, 1001, 0, b'0', 0),
  (10004, 1001, 204, 1001, 0, b'0', 0),
  (10005, 1001, 205, 1001, 0, b'0', 0),

  -- 课程1002：主角201在组内，但不是队长，由学生202担任队长
  (10006, 1002, 201, 1002, 0, b'0', 0),
  (10007, 1002, 202, 1002, 1, b'0', 0),
  (10008, 1002, 203, 1002, 0, b'0', 0),
  (10009, 1002, 204, 1002, 0, b'0', 0),
  (10010, 1002, 205, 1002, 0, b'0', 0),
  (10011, 1002, 206, 1002, 0, b'0', 0),

  -- 课程1003：主角201是队长，其他3个学生
  (10012, 1003, 201, 1003, 1, b'0', 0),
  (10013, 1003, 202, 1003, 0, b'0', 0),
  (10014, 1003, 203, 1003, 0, b'0', 0),
  (10015, 1003, 204, 1003, 0, b'0', 0),

  -- 课程1004：主角201是队长，其他4个学生
  (10016, 1004, 201, 1004, 1, b'0', 0),
  (10017, 1004, 202, 1004, 0, b'0', 0),
  (10018, 1004, 203, 1004, 0, b'0', 0),
  (10019, 1004, 204, 1004, 0, b'0', 0),
  (10020, 1004, 205, 1004, 0, b'0', 0),

  -- 课程1005：其他学生（主角不选）
  (10021, 1005, 206, 1005, 1, b'0', 0),
  (10022, 1005, 207, 1005, 0, b'0', 0),
  (10023, 1005, 208, 1005, 0, b'0', 0),
  (10024, 1005, 209, 1005, 0, b'0', 0);

--
-- 9. 学生作业（course_student_work）
--    为主角学生201创建大量作业记录
--    包含个人作业和团队作业（含贡献度）
--
INSERT INTO course_student_work (
  id, course_id, story_id, student_id,
  submit_id, submit_name,
  group_id, teamwork, contribution,
  file_name, file_url,
  score, team_score,
  recommend, recommend_rank,
  like_count, favorite_count,
  creator, deleted, tenant_id
) VALUES
  -- 课程1001：主角201的作业（部分示例，实际应该有更多）
  (100001, 1001, 10001, 201, 201, '主角学生', NULL, 0, NULL, '选题报告_主角.docx', 'https://example.com/files/1001/10001/stu201.docx', 9.5, NULL, b'1', 5, 5, 2, 'teacher_zhang', b'0', 0),
  (100002, 1001, 10002, 201, 201, '主角学生', 1001, 1, 40.0, '需求调研_软工G1_队长.docx', 'https://example.com/files/1001/10002/g1_leader.docx', 19.0, 19.0, b'1', 5, 6, 3, 'teacher_zhang', b'0', 0),
  (100003, 1001, 10002, 202, 201, '主角学生', 1001, 1, 20.0, '需求调研_软工G1_202.docx', 'https://example.com/files/1001/10002/g1_202.docx', 19.0, 19.0, b'1', 4, 2, 1, 'teacher_zhang', b'0', 0),
  (100004, 1001, 10003, 201, 201, '主角学生', NULL, 0, NULL, '用例图_主角.docx', 'https://example.com/files/1001/10003/stu201.docx', 14.5, NULL, b'1', 4, 3, 1, 'teacher_zhang', b'0', 0),
  (100005, 1001, 10005, 201, 201, '主角学生', 1001, 1, 50.0, '架构设计_软工G1_队长.docx', 'https://example.com/files/1001/10005/g1_leader.docx', 28.5, 28.5, b'1', 5, 7, 4, 'teacher_zhang', b'0', 0),

  -- 课程1002：主角201的作业
  (200001, 1002, 20001, 201, 201, '主角学生', NULL, 0, NULL, 'HTML练习_主角.html', 'https://example.com/files/1002/20001/stu201.html', 9.0, NULL, b'1', 4, 4, 2, 'teacher_wang', b'0', 0),
  (200002, 1002, 20003, 201, 201, '主角学生', 1002, 1, 35.0, 'React组件_全栈G1_主角.docx', 'https://example.com/files/1002/20003/g1_201.docx', 24.0, 24.0, b'1', 5, 5, 3, 'teacher_wang', b'0', 0),
  (200003, 1002, 20005, 201, 201, '主角学生', 1002, 1, 45.0, 'API设计_全栈G1_队长.docx', 'https://example.com/files/1002/20005/g1_leader.docx', 28.0, 28.0, b'1', 5, 6, 3, 'teacher_wang', b'0', 0),

  -- 课程1003：主角201的作业
  (300001, 1003, 30001, 201, 201, '主角学生', NULL, 0, NULL, 'ML理论_主角.docx', 'https://example.com/files/1003/30001/stu201.docx', 14.5, NULL, b'1', 5, 4, 2, 'teacher_li', b'0', 0),
  (300002, 1003, 30006, 201, 201, '主角学生', 1003, 1, 50.0, '神经网络_AI-G1_队长.docx', 'https://example.com/files/1003/30006/g1_leader.docx', 33.0, 33.0, b'1', 5, 5, 3, 'teacher_li', b'0', 0),

  -- 课程1004：主角201的作业
  (400001, 1004, 40001, 201, 201, '主角学生', NULL, 0, NULL, '顺序表_主角.cpp', 'https://example.com/files/1004/40001/stu201.cpp', 14.5, NULL, b'1', 4, 3, 1, 'teacher_zhao', b'0', 0),
  (400002, 1004, 40005, 201, 201, '主角学生', 1004, 1, 40.0, '二叉树遍历_算法G1_主角.cpp', 'https://example.com/files/1004/40005/g1_201.cpp', 24.0, 24.0, b'1', 5, 4, 2, 'teacher_zhao', b'0', 0),
  (400003, 1004, 40007, 201, 201, '主角学生', 1004, 1, 45.0, '图操作_算法G1_队长.cpp', 'https://example.com/files/1004/40007/g1_leader.cpp', 28.5, 28.5, b'1', 5, 5, 3, 'teacher_zhao', b'0', 0);

--
-- 10. 优秀作业点赞和收藏
--
INSERT INTO course_student_work_like (
  work_id, story_id, user_id,
  deleted, tenant_id
) VALUES
  (100001, 10001, 202, 0, 0),
  (100001, 10001, 203, 0, 0),
  (100002, 10002, 202, 0, 0),
  (100002, 10002, 203, 0, 0),
  (200001, 20001, 202, 0, 0),
  (200001, 20001, 203, 0, 0),
  (300001, 30001, 202, 0, 0),
  (300001, 30001, 203, 0, 0),
  (400001, 40001, 202, 0, 0),
  (400001, 40001, 203, 0, 0)
ON DUPLICATE KEY UPDATE deleted = VALUES(deleted);

INSERT INTO course_student_work_favorite (
  work_id, story_id, user_id,
  deleted, tenant_id
) VALUES
  (100001, 10001, 202, 0, 0),
  (100002, 10002, 203, 0, 0),
  (200001, 20001, 202, 0, 0),
  (300001, 30001, 203, 0, 0),
  (400001, 40001, 202, 0, 0)
ON DUPLICATE KEY UPDATE deleted = VALUES(deleted);

--
-- 11. 任务资料（部分任务添加资料）
--
INSERT IGNORE INTO course_map_story_material (
  id, course_id, story_id,
  material_name, material_type, file_name, content,
  remark, deleted, tenant_id
) VALUES
  (10001, 1001, 10002, '需求调研模板', 5, 'requirement_template.docx', 'https://example.com/files/materials/req_template.docx', '需求调研报告模板', b'0', 0),
  (10002, 1001, 10005, '架构设计规范', 1, NULL, 'https://example.com/docs/arch_guide', '系统架构设计规范文档', b'0', 0),
  (20001, 1002, 20005, 'RESTful API设计指南', 1, NULL, 'https://example.com/docs/api_guide', 'API设计最佳实践', b'0', 0),
  (30001, 1003, 30006, '神经网络实现示例', 5, 'nn_example.py', 'https://example.com/files/materials/nn_example.py', '神经网络实现参考代码', b'0', 0),
  (40001, 1004, 40007, '图算法实验指导', 5, 'graph_lab_guide.pdf', 'https://example.com/files/materials/graph_guide.pdf', '图算法实验指导书', b'0', 0);

--
-- 12. 讨论（为主角学生201创建一些讨论）
--
INSERT INTO discussions (
  story_id, course_id, user_id, user_name, content,
  likes, reply_to, deleted, tenant_id
) VALUES
  (10002, 1001, 201, '主角学生', '老师，需求调研需要访谈多少用户？', 2, NULL, b'0', 0),
  (10005, 1001, 201, '主角学生', '系统架构设计时需要考虑哪些因素？', 1, NULL, b'0', 0),
  (20005, 1002, 201, '主角学生', 'RESTful API设计有什么最佳实践？', 3, NULL, b'0', 0),
  (30006, 1003, 201, '主角学生', '神经网络训练时如何防止过拟合？', 2, NULL, b'0', 0),
  (40007, 1004, 201, '主角学生', '图的邻接矩阵和邻接表各有什么优缺点？', 1, NULL, b'0', 0);

--
-- 附加大数据（原 mock_data_large_extra.sql 已内联）
--
-- 1. 补充更多学生（提升整体规模）
--
INSERT INTO `user` (
  id, username, password_hash, nickname,
  dept_id, email, phone_number, job_number,
  user_role, status, deleted, tenant_id
) VALUES
  (216, 'stu216', '123456', '学生216', 101, '216001@example.com', '13900002216', 'S216', 0, 1, 0, 0),
  (217, 'stu217', '123456', '学生217', 101, '217001@example.com', '13900002217', 'S217', 0, 1, 0, 0),
  (218, 'stu218', '123456', '学生218', 101, '218001@example.com', '13900002218', 'S218', 0, 1, 0, 0),
  (219, 'stu219', '123456', '学生219', 101, '219001@example.com', '13900002219', 'S219', 0, 1, 0, 0),
  (220, 'stu220', '123456', '学生220', 101, '220001@example.com', '13900002220', 'S220', 0, 1, 0, 0)
ON DUPLICATE KEY UPDATE
  username     = VALUES(username),
  nickname     = VALUES(nickname),
  email        = VALUES(email),
  phone_number = VALUES(phone_number),
  job_number   = VALUES(job_number);

--
-- 2. 为现有课程再增加一些小组和选课记录
--    这样教师端查看“所有小组/所有学生”时数据更饱满
--
INSERT IGNORE INTO course_group (
  id, course_id, group_name, max_size, current_size,
  group_code, deleted, tenant_id
) VALUES
  (1101, 1001, '软工-第2组', 5, 5, 'SE-G2', b'0', 0),
  (1105, 1001, '软工-第3组', 5, 5, 'SE-G3', b'0', 0),
  (1102, 1002, '全栈-第2组', 6, 5, 'WEB-G2', b'0', 0),
  (1103, 1003, 'AI-第2组',   4, 3, 'AI-G2',  b'0', 0),
  (1104, 1004, '算法-第2组', 5, 4, 'DS-G2',  b'0', 0);

INSERT IGNORE INTO course_student (
  id, course_id, student_id, group_id, leader,
  deleted, tenant_id
) VALUES
  -- 软工第2组：竞争小组A（5人）
  (11001, 1001, 206, 1101, 1, b'0', 0),
  (11002, 1001, 207, 1101, 0, b'0', 0),
  (11003, 1001, 208, 1101, 0, b'0', 0),
  (11004, 1001, 209, 1101, 0, b'0', 0),
  (11017, 1001, 210, 1101, 0, b'0', 0),

  -- 软工第3组：竞争小组B（5人）
  (11018, 1001, 211, 1105, 1, b'0', 0),
  (11019, 1001, 212, 1105, 0, b'0', 0),
  (11020, 1001, 213, 1105, 0, b'0', 0),
  (11021, 1001, 214, 1105, 0, b'0', 0),
  (11022, 1001, 215, 1105, 0, b'0', 0),

  -- 全栈第2组
  (11005, 1002, 209, 1102, 1, b'0', 0),
  (11006, 1002, 210, 1102, 0, b'0', 0),
  (11007, 1002, 211, 1102, 0, b'0', 0),
  (11008, 1002, 217, 1102, 0, b'0', 0),
  (11009, 1002, 218, 1102, 0, b'0', 0),

  -- AI第2组
  (11010, 1003, 212, 1103, 1, b'0', 0),
  (11011, 1003, 213, 1103, 0, b'0', 0),
  (11012, 1003, 219, 1103, 0, b'0', 0),

  -- 算法第2组
  (11013, 1004, 214, 1104, 1, b'0', 0),
  (11014, 1004, 215, 1104, 0, b'0', 0),
  (11015, 1004, 220, 1104, 0, b'0', 0),
  (11016, 1004, 216, 1104, 0, b'0', 0);

--
-- 3. 为更多任务补充学生作业记录
--    目标：每门课至少有 8-10 个任务拥有多名学生的作业
--
INSERT INTO course_student_work (
  id, course_id, story_id, student_id,
  submit_id, submit_name,
  group_id, teamwork, contribution,
  file_name, file_url,
  score, team_score,
  recommend, recommend_rank,
  like_count, favorite_count,
  creator, deleted, tenant_id
) VALUES
  -- ====== 课程1001：为若干任务增加更多学生作业 ======
  -- 任务10001（个人）：再加3个学生
  (100010, 1001, 10001, 202, 202, '学生202', NULL, 0, NULL,
   '选题报告_学生202.docx', 'https://example.com/files/1001/10001/stu202.docx',
   9.0, NULL, b'0', NULL, 1, 0, 'teacher_zhang', b'0', 0),
  (100011, 1001, 10001, 203, 203, '学生203', NULL, 0, NULL,
   '选题报告_学生203.docx', 'https://example.com/files/1001/10001/stu203.docx',
   8.8, NULL, b'0', NULL, 0, 0, 'teacher_zhang', b'0', 0),
  (100012, 1001, 10001, 204, 204, '学生204', NULL, 0, NULL,
   '选题报告_学生204.docx', 'https://example.com/files/1001/10001/stu204.docx',
   9.2, NULL, b'1', 4, 2, 1, 'teacher_zhang', b'0', 0),

  -- 任务10003（个人）：多几个作业
  (100013, 1001, 10003, 202, 202, '学生202', NULL, 0, NULL,
   '用例图_学生202.docx', 'https://example.com/files/1001/10003/stu202.docx',
   8.9, NULL, b'0', NULL, 0, 0, 'teacher_zhang', b'0', 0),
  (100014, 1001, 10003, 203, 203, '学生203', NULL, 0, NULL,
   '用例图_学生203.docx', 'https://example.com/files/1001/10003/stu203.docx',
   9.1, NULL, b'1', 5, 3, 1, 'teacher_zhang', b'0', 0),

  -- 任务10007（团队-全员）：为第1组所有成员补齐记录
  (100015, 1001, 10007, 201, 201, '主角学生', 1001, 1, 35.0,
   '核心模块_G1_201.docx', 'https://example.com/files/1001/10007/g1_201.docx',
   27.0, 27.0, b'1', 5, 4, 2, 'teacher_zhang', b'0', 0),
  (100016, 1001, 10007, 202, 201, '主角学生', 1001, 1, 25.0,
   '核心模块_G1_202.docx', 'https://example.com/files/1001/10007/g1_202.docx',
   27.0, 27.0, b'0', NULL, 1, 0, 'teacher_zhang', b'0', 0),
  (100017, 1001, 10007, 203, 201, '主角学生', 1001, 1, 20.0,
   '核心模块_G1_203.docx', 'https://example.com/files/1001/10007/g1_203.docx',
   27.0, 27.0, b'0', NULL, 0, 0, 'teacher_zhang', b'0', 0),
  (100018, 1001, 10007, 204, 201, '主角学生', 1001, 1, 10.0,
   '核心模块_G1_204.docx', 'https://example.com/files/1001/10007/g1_204.docx',
   27.0, 27.0, b'0', NULL, 0, 0, 'teacher_zhang', b'0', 0),
  (100019, 1001, 10007, 205, 201, '主角学生', 1001, 1, 10.0,
   '核心模块_G1_205.docx', 'https://example.com/files/1001/10007/g1_205.docx',
   27.0, 27.0, b'0', NULL, 0, 0, 'teacher_zhang', b'0', 0),

  -- ====== 课程1002：为任务20001/20003/20005/20009 加更多作业 ======
  (200010, 1002, 20001, 202, 202, '学生202', NULL, 0, NULL,
   'HTML练习_学生202.html', 'https://example.com/files/1002/20001/stu202.html',
   8.5, NULL, b'0', NULL, 0, 0, 'teacher_wang', b'0', 0),
  (200011, 1002, 20001, 203, 203, '学生203', NULL, 0, NULL,
   'HTML练习_学生203.html', 'https://example.com/files/1002/20001/stu203.html',
   9.2, NULL, b'1', 4, 2, 1, 'teacher_wang', b'0', 0),

  (200012, 1002, 20003, 202, 201, '主角学生', 1002, 1, 25.0,
   'React组件_WEB-G1_202.docx', 'https://example.com/files/1002/20003/g1_202.docx',
   24.0, 24.0, b'0', NULL, 0, 0, 'teacher_wang', b'0', 0),
  (200013, 1002, 20003, 203, 201, '主角学生', 1002, 1, 20.0,
   'React组件_WEB-G1_203.docx', 'https://example.com/files/1002/20003/g1_203.docx',
   24.0, 24.0, b'0', NULL, 0, 0, 'teacher_wang', b'0', 0),

  (200014, 1002, 20005, 202, 201, '主角学生', 1002, 1, 30.0,
   'API设计_WEB-G1_202.docx', 'https://example.com/files/1002/20005/g1_202.docx',
   28.0, 28.0, b'0', NULL, 0, 0, 'teacher_wang', b'0', 0),

  (200015, 1002, 20009, 201, 201, '主角学生', 1002, 1, 40.0,
   '联调测试_WEB-G1_201.docx', 'https://example.com/files/1002/20009/g1_201.docx',
   26.0, 26.0, b'1', 5, 4, 2, 'teacher_wang', b'0', 0),
  (200016, 1002, 20009, 202, 201, '主角学生', 1002, 1, 30.0,
   '联调测试_WEB-G1_202.docx', 'https://example.com/files/1002/20009/g1_202.docx',
   26.0, 26.0, b'0', NULL, 0, 0, 'teacher_wang', b'0', 0),

  -- ====== 课程1003/1004：再补充几条作业 ======
  (300020, 1003, 30003, 201, 201, '主角学生', 1003, 1, 40.0,
   '分类算法_AI-G1_201.ipynb', 'https://example.com/files/1003/30003/g1_201.ipynb',
   27.0, 27.0, b'1', 5, 3, 2, 'teacher_li', b'0', 0),
  (300021, 1003, 30003, 202, 201, '主角学生', 1003, 1, 30.0,
   '分类算法_AI-G1_202.ipynb', 'https://example.com/files/1003/30003/g1_202.ipynb',
   27.0, 27.0, b'0', NULL, 0, 0, 'teacher_li', b'0', 0),

  (400020, 1004, 40005, 202, 201, '主角学生', 1004, 1, 30.0,
   '二叉树遍历_算法G1_202.cpp', 'https://example.com/files/1004/40005/g1_202.cpp',
   23.0, 23.0, b'0', NULL, 0, 0, 'teacher_zhao', b'0', 0),
  (400021, 1004, 40005, 203, 201, '主角学生', 1004, 1, 20.0,
   '二叉树遍历_算法G1_203.cpp', 'https://example.com/files/1004/40005/g1_203.cpp',
   23.0, 23.0, b'0', NULL, 0, 0, 'teacher_zhao', b'0', 0);

--
-- 4. 补充更多点赞和收藏，增强“热度”数据
--
INSERT INTO course_student_work_like (
  work_id, story_id, user_id,
  deleted, tenant_id
) VALUES
  (100010, 10001, 201, 0, 0),
  (100012, 10001, 203, 0, 0),
  (100015, 10007, 202, 0, 0),
  (200011, 20001, 201, 0, 0),
  (200015, 20009, 203, 0, 0),
  (300020, 30003, 203, 0, 0),
  (400021, 40005, 202, 0, 0)
ON DUPLICATE KEY UPDATE deleted = VALUES(deleted);

INSERT INTO course_student_work_favorite (
  work_id, story_id, user_id,
  deleted, tenant_id
) VALUES
  (100012, 10001, 201, 0, 0),
  (100015, 10007, 203, 0, 0),
  (200011, 20001, 202, 0, 0),
  (300020, 30003, 202, 0, 0),
  (400021, 40005, 203, 0, 0)
ON DUPLICATE KEY UPDATE deleted = VALUES(deleted);

--
-- 5. 任务浏览统计（task_views）
--    让任务看板 / 热度统计接口有真实数据
--
INSERT INTO task_views (
  story_id, course_id, user_id,
  views, first_view_time, last_view_time,
  tenant_id
) VALUES
  (10002, 1001, 201, 8, '2024-03-01 10:00:00', '2024-03-20 20:00:00', 0),
  (10002, 1001, 202, 5, '2024-03-02 09:00:00', '2024-03-18 18:00:00', 0),
  (10005, 1001, 201, 10,'2024-03-20 10:00:00', '2024-04-05 21:00:00', 0),
  (20005, 1002, 201, 9, '2024-10-10 09:30:00', '2024-10-25 19:30:00', 0),
  (20005, 1002, 202, 6, '2024-10-12 11:00:00', '2024-10-24 17:00:00', 0),
  (30006, 1003, 201, 7, '2024-11-01 08:00:00', '2024-11-20 22:00:00', 0),
  (40007, 1004, 201, 6, '2025-04-10 09:00:00', '2025-04-30 20:00:00', 0),
  (40007, 1004, 202, 4, '2025-04-12 09:30:00', '2025-04-28 18:30:00', 0)
ON DUPLICATE KEY UPDATE
  views = VALUES(views),
  last_view_time = VALUES(last_view_time);

--
-- 6. 私信消息（messages）
--    让消息中心 / 私信接口有多轮往来记录
--
INSERT INTO messages (
  sender_id, receiver_id, content,
  is_read, creator, deleted, tenant_id
) VALUES
  (201, 100, '老师好，我在做需求调研作业时，对访谈对象选择有些疑问。', 0, 'hero_student', 0, 0),
  (100, 201, '可以优先选择潜在真实用户，如果不方便，可以选择同学或教师模拟用户。', 0, 'teacher_zhang', 0, 0),
  (201, 101, '老师，我在设计RESTful API的路径规范时有点拿不准。', 0, 'hero_student', 0, 0),
  (101, 201, '路径尽量使用名词复数形式，使用小写加中划线，保持风格统一。', 0, 'teacher_wang', 0, 0),
  (201, 102, '老师，神经网络训练过程中loss下降到一定程度就不再变化了怎么办？', 0, 'hero_student', 0, 0),
  (102, 201, '可以尝试降低学习率、增加正则化或者使用早停策略。', 0, 'teacher_li', 0, 0),
  (201, 103, '老师，最短路径算法我有点混淆，什么时候用Dijkstra，什么时候用Floyd？', 0, 'hero_student', 0, 0),
  (103, 201, '图稀疏且节点较多时适合用Dijkstra，多源最短路径或节点较少时适合用Floyd。', 0, 'teacher_zhao', 0, 0)
ON DUPLICATE KEY UPDATE
  content = VALUES(content),
  is_read = VALUES(is_read);

--
-- 7. 讨论补充：为原有讨论增加老师回复 / 其他学生跟帖
--
INSERT INTO discussions (
  story_id, course_id, user_id, user_name, content,
  likes, reply_to, deleted, tenant_id
) VALUES
  -- 老师对主角提问的回复
  (10002, 1001, 100, '张老师', '一般建议至少访谈3-5位不同角色的用户，确保需求多样性。', 3, 1, b'0', 0),
  (10005, 1001, 100, '张老师', '架构设计时要考虑性能、扩展性、可靠性、安全性等多方面因素。', 2, 2, b'0', 0),
  (20005, 1002, 101, '王老师', 'RESTful API设计要注意资源划分清晰、状态码语义明确、错误信息一致。', 4, 3, b'0', 0),
  (30006, 1003, 102, '李老师', '可以尝试使用dropout、L2正则化以及数据增强等方式缓解过拟合。', 3, 4, b'0', 0),
  (40007, 1004, 103, '赵老师', '邻接矩阵适合稠密图，查询边更快；邻接表更适合稀疏图，节省空间。', 2, 5, b'0', 0),

  -- 其他学生跟帖
  (10002, 1001, 202, '学生202', '同问，我们小组现在只有2位真实用户访谈。', 1, 1, b'0', 0),
  (20005, 1002, 203, '学生203', '老师，路径中是否建议带版本号，比如 /api/v1/...？', 1, 3, b'0', 0)
ON DUPLICATE KEY UPDATE
  content = VALUES(content);

--
-- 统一已打分作业的点评状态与评语
-- 对于有分数的作业：标记为已点评，补充评分人/时间/评语等字段
--
UPDATE course_student_work
SET
  status      = 1,
  score_by    = CASE course_id
                  WHEN 1001 THEN 100
                  WHEN 1002 THEN 101
                  WHEN 1003 THEN 102
                  WHEN 1004 THEN 103
                  ELSE score_by
                END,
  score_time  = IF(score_time IS NULL, DATE_SUB(CURDATE(), INTERVAL 1 DAY), score_time),
  content     = COALESCE(
                  content,
                  CONCAT('本次作业得分 ', score, ' 分，整体完成较好，请根据老师建议继续完善。')
                ),
  round       = COALESCE(round, 1),
  last_one    = COALESCE(last_one, 1)
WHERE course_id BETWEEN 1001 AND 1005
  AND deleted = b'0'
  AND score IS NOT NULL;

--
-- 为 course_map_story 补充缺省字段（必做 / 难度 / 最大提交次数 / 解锁方式）
--
UPDATE course_map_story
SET
  required    = COALESCE(required, b'1'),
  difficulty  = COALESCE(difficulty, 3),
  max_submit  = COALESCE(max_submit, 3),
  submit_type = COALESCE(submit_type, 2),
  unlock_type = COALESCE(unlock_type, 3)
WHERE course_id BETWEEN 1001 AND 1005
  AND deleted = b'0';

--
-- 调整任务时间到距离当前日期附近，划分为三类：已过期 / 进行中 / 未开始
-- 说明：使用 CURDATE() 使脚本在不同时间执行都能生成“接近现在”的时间
--   已过期：开始和结束都早于今天（约 60~30 天前）
--   进行中：今天在开始和结束之间（约 前10天 ~ 后10天）
--   未开始：开始和结束都晚于今天（约 后5天 ~ 后35天）
--
-- 已过期作业
UPDATE course_map_story
SET start_time = DATE_SUB(CURDATE(), INTERVAL 60 DAY),
    end_time   = DATE_SUB(CURDATE(), INTERVAL 30 DAY)
WHERE id IN (
  10001,10002,10003,10004,
  20001,20002,20003,20004,
  30001,30002,30003,
  40001,40002,40003,40004
);

-- 正在进行中的作业
UPDATE course_map_story
SET start_time = DATE_SUB(CURDATE(), INTERVAL 10 DAY),
    end_time   = DATE_ADD(CURDATE(), INTERVAL 10 DAY)
WHERE id IN (
  10005,10006,10007,10008,10009,10010,
  20005,20006,20007,20008,20009,
  30004,30005,30006,30007,30008,
  40005,40006,40007,40008,40009,40010
);

-- 尚未开始的作业
UPDATE course_map_story
SET start_time = DATE_ADD(CURDATE(), INTERVAL 5 DAY),
    end_time   = DATE_ADD(CURDATE(), INTERVAL 35 DAY)
WHERE id IN (
  10011,10012,10013,10014,10015,
  20010,20011,20012,
  30009,30010,30011,
  40011,40012,40013
);

SET FOREIGN_KEY_CHECKS = 1;

