# 任务资料测试文件生成指南

本目录用于存放任务资料的测试文件。由于 PDF 和 DOC/DOCX 是二进制格式，需要特定的工具来创建。

## 快速创建测试文件

### Windows 系统

#### 使用 PowerShell 创建简单测试文件（仅用于测试文件类型验证）

```powershell
# 创建占位PDF文件（注意：这不是真正的PDF，仅用于测试文件类型验证）
New-Item -ItemType File -Name "test_需求分析.pdf" -Force

# 创建占位DOC文件
New-Item -ItemType File -Name "test_任务说明.doc" -Force

# 创建占位DOCX文件
New-Item -ItemType File -Name "test_开发规范.docx" -Force
```

**注意**：上述方法创建的文件不是真正的PDF/DOC格式，仅能用于测试文件类型验证（扩展名检查）。要创建真正的可打开文件，请使用下面的方法。

#### 创建真正的PDF文件（推荐使用 Word）

1. 打开 Microsoft Word
2. 输入测试内容，例如：
   ```
   任务资料测试文件
   
   这是一个用于测试的任务资料文件。
   文件格式：PDF
   创建时间：2025-12-02
   ```
3. 另存为 → 选择 "PDF (*.pdf)"
4. 将文件复制到 `uploads/materials/` 目录

#### 创建真正的DOC/DOCX文件

1. 打开 Microsoft Word
2. 输入测试内容
3. 另存为 → 选择 "Word 文档 (*.docx)" 或 "Word 97-2003 文档 (*.doc)"
4. 将文件复制到 `uploads/materials/` 目录

### 使用在线工具

1. 访问 [Google 文档](https://docs.google.com/document/)
2. 创建新文档，输入测试内容
3. 文件 → 下载 → 选择格式（PDF 或 Microsoft Word）
4. 将下载的文件放到 `uploads/materials/` 目录

## 推荐的测试文件列表

建议创建以下测试文件：

1. **test_需求分析报告.pdf** - PDF格式的需求分析模板
2. **test_任务说明文档.doc** - DOC格式的任务说明
3. **test_开发规范.docx** - DOCX格式的开发规范
4. **test_测试用例模板.pdf** - PDF格式的测试用例模板

## 测试上传功能

创建测试文件后，可以使用以下方式测试上传：

### 使用 curl（命令行）

```bash
curl -X POST http://localhost:3000/api/upload/material \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@test_需求分析报告.pdf"
```

### 使用 Postman

1. 方法：POST
2. URL：`http://localhost:3000/api/upload/material`
3. Headers：
   - `Authorization: Bearer YOUR_TOKEN`
4. Body：
   - 选择 `form-data`
   - Key: `file` (类型选择 File)
   - Value: 选择要上传的PDF或DOC文件

### 使用前端代码

```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);

const response = await fetch('http://localhost:3000/api/upload/material', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
});

const result = await response.json();
console.log('上传成功，URL:', result.url);
```

## 验证文件类型限制

为了验证文件类型限制是否生效，可以尝试上传不支持的文件类型（如 `.txt`、`.jpg`），应该会收到错误响应：

```json
{
  "message": "任务资料仅支持 PDF 和 DOC/DOCX 格式。当前文件类型: .txt"
}
```

